
#
# Comment the following block in case you have an only HTTP site (no HTTPS).
#
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R,L]
</IfModule>

Options -Indexes
Order allow,deny
Allow from all

RedirectMatch 404 /\.git

# Forbidden access to install, make sure you comment this line
# in case you would like to install the app from the web
RedirectMatch 404 /install

<FilesMatch ".*\.[A-Za-z0-9]+">
	Deny from all
</FilesMatch>
<FilesMatch "^(index\.php)?$">
        Allow from all
</FilesMatch>
<FilesMatch "^(index|service|tilepic)\.php$">
        Allow from all
</FilesMatch>
<FilesMatch "^.*\.(css|gif|jpg|png|js|woff|woff2|ttf|swf|map|tif|m4v|xml|ply|stl|html|json|mp3|wav|aiff|tiff|obj|bmp|mp4|pdf|svg)$">
        Allow from all
</FilesMatch>

<FilesMatch "Vagrantfile.*|composer.*">
	Deny from all
</FilesMatch>

<IfModule mod_rewrite.c>
	RewriteEngine on
	
	<IfModule mod_env.c>
		SetEnv HTTP_MOD_REWRITE On
	</IfModule>
	
	RewriteRule "(^|/)\.(?!well-known\/)" - [F]
	
	# Pass all requests not referring directly 
	# to files in the filesystem to index.php.
	RewriteCond %{REQUEST_FILENAME} !-f
	RewriteCond %{REQUEST_FILENAME} !-d
	RewriteCond %{REQUEST_URI} !=/favicon.ico
	RewriteCond %{REQUEST_URI} !=/server-status
	RewriteCond %{REQUEST_URI} !=/robots.txt
	RewriteRule ^ index.php%{REQUEST_URI} [L]	

	# Block all TRACE/TRACK requests
	RewriteCond %{REQUEST_METHOD} ^TRAC[EK]
	RewriteRule .* - [F]


</IfModule>
